Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.getExportsForFiles = getExportsForFiles;
exports.getImportsForEntireFileContent = getImportsForEntireFileContent;

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _utilsBufferedNodeProcessExecutorPoolJs = require('../utils/BufferedNodeProcessExecutorPool.js');

var _utilsBufferedNodeProcessExecutorPoolJs2 = _interopRequireDefault(_utilsBufferedNodeProcessExecutorPoolJs);

'use babel';

var Q = require('q');
var path = require('path');
var _ = require('lodash');

var EXPORT_DEFAULT = 'ExportDefaultDeclaration';
var EXPORT_NAMED = 'ExportNamedDeclaration';
var IMPORT_DEFAULT = 'ImportDefaultSpecifier';
var IMPORT_DECLARATION = 'ImportDeclaration';
var IMPORT_DEFAULT_SPECIFIER = 'ImportDefaultSpecifier';
var IMPORT_NAMESPACE_SPECIFIER = 'ImportNamespaceSpecifier';
var VARIABLE_DECLARATION = 'VariableDeclaration';
var FULFILLED_PROMISE = 'fulfilled';

var nodeProcessExecutor = new _utilsBufferedNodeProcessExecutorPoolJs2['default']();

function callAstServer(args) {
  return nodeProcessExecutor.execute(path.resolve(__dirname, './AstServer.js'), args);
}

function getExportsForFiles(files) {
  return Q.allSettled(files.map(function (file) {
    return callAstServer([file]);
  })).then(function (promises) {

    promises.filter(function (response) {
      return response.state !== FULFILLED_PROMISE;
    }).forEach(function (response) {
      console.error('Couldn\'t process for export index - ' + response.reason.args[0], response.reason);
    });

    return _.flatten(promises.filter(function (response) {
      return response.state === FULFILLED_PROMISE;
    }).filter(function (response) {
      return response.value.data !== '';
    }).map(function (response) {
      var file = response.value.args[0];

      var data = undefined;
      try {
        data = JSON.parse(response.value.data);
      } catch (ex) {
        data = { body: [] };
      }

      return _.flatten(data.body.filter(function (astRecord) {
        return (astRecord.type === EXPORT_NAMED || astRecord.type === EXPORT_DEFAULT) && astRecord.declaration;
      }).map(function (astRecord) {
        if (astRecord.type === EXPORT_DEFAULT) {
          if (!astRecord.declaration.id) {
            var importedFileName = path.basename(file);

            // Default export without name
            return {
              text: importedFileName.replace(path.extname(importedFileName), ''),
              file: file,
              type: astRecord.declaration.type,
              def: true
            };
          } else {
            // Default export with name
            return {
              text: astRecord.declaration.id.name,
              file: file,
              type: astRecord.declaration.type,
              def: true
            };
          }
        } else {
          // Named export for variables
          if (astRecord.declaration.type === VARIABLE_DECLARATION) {
            return _.map(astRecord.declaration.declarations, function (declaration) {
              return {
                text: declaration.id.name,
                file: file,
                type: declaration.type,
                def: false
              };
            });
          } else {
            // Named export other than variables
            return {
              text: astRecord.declaration.id.name,
              file: file,
              type: astRecord.declaration.type,
              def: false
            };
          }
        }
      })).filter(function (record) {
        return record.text;
      });
    }));
  });
}

function getImportsForEntireFileContent(content, version) {
  return callAstServer(['--no-file', content]).then(function (response) {
    var imports = JSON.parse(response.data).body.filter(function (record) {
      return record.type === IMPORT_DECLARATION;
    }).map(function (record) {
      return {
        file: record.source.value,
        specifiers: record.specifiers.map(function (specifier) {
          var textImported = undefined;
          if (specifier.type !== IMPORT_NAMESPACE_SPECIFIER) {
            textImported = specifier.imported ? specifier.imported.name : specifier.local.name;
          } else {
            textImported = '*';
          }

          return {
            textLocal: specifier.local.name,
            textImported: textImported,
            def: specifier.type === IMPORT_DEFAULT_SPECIFIER || specifier.type === IMPORT_NAMESPACE_SPECIFIER
          };
        })
      };
    });

    return {
      imports: imports,
      version: version
    };
  });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9rc3dlZGJlcmcvLmF0b20vcGFja2FnZXMvanMtYXV0b2ltcG9ydC9saWIvYXN0L0FzdFByb3ZpZGVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O3NEQUU0Qyw2Q0FBNkM7Ozs7QUFGekYsV0FBVyxDQUFDOztBQUlaLElBQU0sQ0FBQyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUN2QixJQUFNLElBQUksR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDN0IsSUFBTSxDQUFDLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDOztBQUU1QixJQUFNLGNBQWMsR0FBRywwQkFBMEIsQ0FBQztBQUNsRCxJQUFNLFlBQVksR0FBRyx3QkFBd0IsQ0FBQztBQUM5QyxJQUFNLGNBQWMsR0FBRyx3QkFBd0IsQ0FBQztBQUNoRCxJQUFNLGtCQUFrQixHQUFHLG1CQUFtQixDQUFDO0FBQy9DLElBQU0sd0JBQXdCLEdBQUcsd0JBQXdCLENBQUM7QUFDMUQsSUFBTSwwQkFBMEIsR0FBRywwQkFBMEIsQ0FBQztBQUM5RCxJQUFNLG9CQUFvQixHQUFHLHFCQUFxQixDQUFDO0FBQ25ELElBQU0saUJBQWlCLEdBQUcsV0FBVyxDQUFDOztBQUV0QyxJQUFNLG1CQUFtQixHQUFHLHlEQUFxQyxDQUFDOztBQUVsRSxTQUFTLGFBQWEsQ0FBQyxJQUFJLEVBQUU7QUFDM0IsU0FBTyxtQkFBbUIsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsZ0JBQWdCLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztDQUNyRjs7QUFFTSxTQUFTLGtCQUFrQixDQUFDLEtBQUssRUFBRTtBQUN4QyxTQUFPLENBQUMsQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxVQUFDLElBQUk7V0FBSyxhQUFhLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztHQUFBLENBQUMsQ0FBQyxDQUM1RCxJQUFJLENBQUMs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QUcsRUFBRSxTQUFTLENBQUMsSUFBSSxLQUFLLHdCQUF3QixJQUFJLFNBQVMsQ0FBQyxJQUFJLEtBQUssMEJBQTBCO1dBQ2xHLENBQUM7U0FDSCxDQUFDO09BQ0gsQ0FBQztLQUNILENBQUMsQ0FBQzs7QUFFSCxXQUFPO0FBQ0wsYUFBTyxFQUFFLE9BQU87QUFDaEIsYUFBTyxFQUFFLE9BQU87S0FDakIsQ0FBQztHQUNMLENBQUMsQ0FBQztDQUNKIiwiZmlsZSI6Ii9Vc2Vycy9rc3dlZGJlcmcvLmF0b20vcGFja2FnZXMvanMtYXV0b2ltcG9ydC9saWIvYXN0L0FzdFByb3ZpZGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCc7XG5cbmltcG9ydCBCdWZmZXJlZE5vZGVQcm9jZXNzRXhlY3V0b3JQb29sIGZyb20gJy4uL3V0aWxzL0J1ZmZlcmVkTm9kZVByb2Nlc3NFeGVjdXRvclBvb2wuanMnXG5cbmNvbnN0IFEgPSByZXF1aXJlKCdxJyk7XG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuY29uc3QgXyA9IHJlcXVpcmUoJ2xvZGFzaCcpO1xuXG5jb25zdCBFWFBPUlRfREVGQVVMVCA9ICdFeHBvcnREZWZhdWx0RGVjbGFyYXRpb24nO1xuY29uc3QgRVhQT1JUX05BTUVEID0gJ0V4cG9ydE5hbWVkRGVjbGFyYXRpb24nO1xuY29uc3QgSU1QT1JUX0RFRkFVTFQgPSAnSW1wb3J0RGVmYXVsdFNwZWNpZmllcic7XG5jb25zdCBJTVBPUlRfREVDTEFSQVRJT04gPSAnSW1wb3J0RGVjbGFyYXRpb24nO1xuY29uc3QgSU1QT1JUX0RFRkFVTFRfU1BFQ0lGSUVSID0gJ0ltcG9ydERlZmF1bHRTcGVjaWZpZXInO1xuY29uc3QgSU1QT1JUX05BTUVTUEFDRV9TUEVDSUZJRVIgPSAnSW1wb3J0TmFtZXNwYWNlU3BlY2lmaWVyJztcbmNvbnN0IFZBUklBQkxFX0RFQ0xBUkFUSU9OID0gJ1ZhcmlhYmxlRGVjbGFyYXRpb24nO1xuY29uc3QgRlVMRklMTEVEX1BST01JU0UgPSAnZnVsZmlsbGVkJztcblxuY29uc3Qgbm9kZVByb2Nlc3NFeGVjdXRvciA9IG5ldyBCdWZmZXJlZE5vZGVQcm9jZXNzRXhlY3V0b3JQb29sKCk7XG5cbmZ1bmN0aW9uIGNhbGxBc3RTZXJ2ZXIoYXJncykge1xuICByZXR1cm4gbm9kZVByb2Nlc3NFeGVjdXRvci5leGVjdXRlKHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsICcuL0FzdFNlcnZlci5qcycpLCBhcmdzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEV4cG9ydHNGb3JGaWxlcyhmaWxlcykge1xuICByZXR1cm4gUS5hbGxTZXR0bGVkKGZpbGVzLm1hcCgoZmlsZSkgPT4gY2FsbEFzdFNlcnZlcihbZmlsZV0pKSlcbiAgICAudGhlbigocHJvbWlzZXMpID0+IHtcblxuICAgICAgcHJvbWlzZXNcbiAgICAgICAgLmZpbHRlcihyZXNwb25zZSA9PiByZXNwb25zZS5zdGF0ZSAhPT0gRlVMRklMTEVEX1BST01JU0UpXG4gICAgICAgIC5mb3JFYWNoKChyZXNwb25zZSkgPT4geyBjb25zb2xlLmVycm9yKGBDb3VsZG4ndCBwcm9jZXNzIGZvciBleHBvcnQgaW5kZXggLSAke3Jlc3BvbnNlLnJlYXNvbi5hcmdzWzBdfWAsIHJlc3BvbnNlLnJlYXNvbik7IH0pO1xuXG4gICAgICByZXR1cm4gXy5mbGF0dGVuKFxuICAgICAgICBwcm9taXNlc1xuICAgICAgICAgIC5maWx0ZXIocmVzcG9uc2UgPT4gcmVzcG9uc2Uuc3RhdGUgPT09IEZVTEZJTExFRF9QUk9NSVNFKVxuICAgICAgICAgIC5maWx0ZXIocmVzcG9uc2UgPT4gcmVzcG9uc2UudmFsdWUuZGF0YSAhPT0gJycpXG4gICAgICAgICAgLm1hcCgocmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGUgPSByZXNwb25zZS52YWx1ZS5hcmdzWzBdO1xuXG4gICAgICAgICAgICBsZXQgZGF0YTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKHJlc3BvbnNlLnZhbHVlLmRhdGEpO1xuICAgICAgICAgICAgfSBjYXRjaChleCkge1xuICAgICAgICAgICAgICBkYXRhID0ge2JvZHk6IFtdfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIF8uZmxhdHRlbihkYXRhXG4gICAgICAgICAgICAgIC5ib2R5XG4gICAgICAgICAgICAgIC5maWx0ZXIoKGFzdFJlY29yZCkgPT4gKGFzdFJlY29yZC50eXBlID09PSBFWFBPUlRfTkFNRUQgfHwgYXN0UmVjb3JkLnR5cGUgPT09IEVYUE9SVF9ERUZBVUxUKSAmJiBhc3RSZWNvcmQuZGVjbGFyYXRpb24pXG4gICAgICAgICAgICAgIC5tYXAoKGFzdFJlY29yZCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChhc3RSZWNvcmQudHlwZSA9PT0gRVhQT1JUX0RFRkFVTFQpIHtcbiAgICAgICAgICAgICAgICAgIGlmICghYXN0UmVjb3JkLmRlY2xhcmF0aW9uLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGltcG9ydGVkRmlsZU5hbWUgPSBwYXRoLmJhc2VuYW1lKGZpbGUpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIERlZmF1bHQgZXhwb3J0IHdpdGhvdXQgbmFtZVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IGltcG9ydGVkRmlsZU5hbWUucmVwbGFjZShwYXRoLmV4dG5hbWUoaW1wb3J0ZWRGaWxlTmFtZSksICcnKSxcbiAgICAgICAgICAgICAgICAgICAgICBmaWxlOiBmaWxlLFxuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IGFzdFJlY29yZC5kZWNsYXJhdGlvbi50eXBlLFxuICAgICAgICAgICAgICAgICAgICAgIGRlZjogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gRGVmYXVsdCBleHBvcnQgd2l0aCBuYW1lXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgdGV4dDogYXN0UmVjb3JkLmRlY2xhcmF0aW9uLmlkLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgZmlsZTogZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBhc3RSZWNvcmQuZGVjbGFyYXRpb24udHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICBkZWY6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgLy8gTmFtZWQgZXhwb3J0IGZvciB2YXJpYWJsZXNcbiAgICAgICAgICAgICAgICAgIGlmIChhc3RSZWNvcmQuZGVjbGFyYXRpb24udHlwZSA9PT0gVkFSSUFCTEVfREVDTEFSQVRJT04pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF8ubWFwKGFzdFJlY29yZC5kZWNsYXJhdGlvbi5kZWNsYXJhdGlvbnMsIChkZWNsYXJhdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBkZWNsYXJhdGlvbi5pZC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZTogZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IGRlY2xhcmF0aW9uLnR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWY6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBOYW1lZCBleHBvcnQgb3RoZXIgdGhhbiB2YXJpYWJsZXNcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBhc3RSZWNvcmQuZGVjbGFyYXRpb24uaWQubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICBmaWxlOiBmaWxlLFxuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IGFzdFJlY29yZC5kZWNsYXJhdGlvbi50eXBlLFxuICAgICAgICAgICAgICAgICAgICAgIGRlZjogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgICAuZmlsdGVyKChyZWNvcmQpID0+IHJlY29yZC50ZXh0KTtcbiAgICAgICAgICB9KVxuICAgICAgKTtcbiAgICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEltcG9ydHNGb3JFbnRpcmVGaWxlQ29udGVudChjb250ZW50LCB2ZXJzaW9uKSB7XG4gIHJldHVybiBjYWxsQXN0U2VydmVyKFsnLS1uby1maWxlJywgY29udGVudF0pXG4gIC50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgIGNvbnN0IGltcG9ydHMgPSBKU09OLnBhcnNlKHJlc3BvbnNlLmRhdGEpXG4gICAgICAuYm9keVxuICAgICAgLmZpbHRlcigocmVjb3JkKSA9PiByZWNvcmQudHlwZSA9PT0gSU1QT1JUX0RFQ0xBUkFUSU9OKVxuICAgICAgLm1hcCgocmVjb3JkKSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZmlsZTogcmVjb3JkLnNvdXJjZS52YWx1ZSxcbiAgICAgICAgICBzcGVjaWZpZXJzOiByZWNvcmQuc3BlY2lmaWVycy5tYXAoKHNwZWNpZmllcikgPT4ge1xuICAgICAgICAgICAgbGV0IHRleHRJbXBvcnRlZDtcbiAgICAgICAgICAgIGlmIChzcGVjaWZpZXIudHlwZSAhPT0gSU1QT1JUX05BTUVTUEFDRV9TUEVDSUZJRVIpIHtcbiAgICAgICAgICAgICAgdGV4dEltcG9ydGVkID0gc3BlY2lmaWVyLmltcG9ydGVkID8gc3BlY2lmaWVyLmltcG9ydGVkLm5hbWUgOiBzcGVjaWZpZXIubG9jYWwubmFtZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRleHRJbXBvcnRlZCA9ICcqJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgdGV4dExvY2FsOiBzcGVjaWZpZXIubG9jYWwubmFtZSxcbiAgICAgICAgICAgICAgdGV4dEltcG9ydGVkOiB0ZXh0SW1wb3J0ZWQsXG4gICAgICAgICAgICAgIGRlZjogc3BlY2lmaWVyLnR5cGUgPT09IElNUE9SVF9ERUZBVUxUX1NQRUNJRklFUiB8fCBzcGVjaWZpZXIudHlwZSA9PT0gSU1QT1JUX05BTUVTUEFDRV9TUEVDSUZJRVJcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpbXBvcnRzOiBpbXBvcnRzLFxuICAgICAgICB2ZXJzaW9uOiB2ZXJzaW9uXG4gICAgICB9O1xuICB9KTtcbn1cbiJdfQ==
//# sourceURL=/Users/kswedberg/.atom/packages/js-autoimport/lib/ast/AstProvider.js
